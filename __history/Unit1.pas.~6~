unit Unit1;

interface

uses
  Winapi.Windows,
  Winapi.Messages,
  System.SysUtils,
  System.Variants,
  System.Classes,
  Vcl.Graphics,
  Vcl.Controls,
  Vcl.Forms,
  Vcl.Dialogs,
  System.Win.ComObj,
  Winapi.ActiveX,
  Vcl.StdCtrls,
  Vcl.ComCtrls,
  SpeechLib_TLB;


type
  TForm1 = class(TForm)
    Button1: TButton;
    RichEdit1: TRichEdit;
    procedure Button1Click(Sender: TObject);
    procedure RichEdit1Change(Sender: TObject);

  private
    { Private declarations }
  public
    { Public declarations }
    comandos: array of string;
    procedure ExecutarComandos(richedit: TRichEdit; const comandos: array of string);

  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
begin
  RichEdit1.SetFocus;
 // Pressiona a tecla "Windows"
  keybd_event(VK_LWIN, 0, 0, 0);

  // Pressiona a tecla "H"
  keybd_event(Ord('H'), MapVirtualKey(Ord('H'), 0), 0, 0);

  // Libera a tecla "H"
  keybd_event(Ord('H'), MapVirtualKey(Ord('H'), 0), KEYEVENTF_KEYUP, 0);

  // Libera a tecla "Windows"
  keybd_event(VK_LWIN, 0, KEYEVENTF_KEYUP, 0);
end;

procedure TForm1.ExecutarComandos(richedit: TRichEdit;
  const comandos: array of string);
var
  i: Integer;
  palavra: string;
  texto: string;
begin
  texto := richedit.Text;
  for i := 0 to High(comandos) do // percorre cada comando na matriz
  begin
    palavra := comandos[i];
    if Pos(palavra, texto) > 0 then // verifica se a palavra existe no texto
    begin
      // faça algo aqui, como executar um comando específico
      ShowMessage('Comando "' + palavra + '" encontrado!');

      if palavra='fechar' then
        close;

      if palavra='Salvar' then
        Showmessage('Salvei no banco de dados');
    end;
  end;

end;

procedure TForm1.RichEdit1Change(Sender: TObject);
begin
  // preenche a matriz de comandos com algumas palavras
  SetLength(comandos, 3);
  comandos[0] := 'Abrir';
  comandos[1] := 'Salvar';
  comandos[2] := 'fechar';


  ExecutarComandos(richedit1, comandos);
end;

end.
